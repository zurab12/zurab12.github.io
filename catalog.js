(function () {
    'use strict';

    var Manifest = {api_host:'http://78.83.112.153:9200',catalogs:{"Rezka":{"search":"/catalog/list?plugin=rezka","search_lazy":true,"movie":{"Новинки":"/catalog/list?plugin=rezka&cat=films&sort=new","Сейчас смотрят":"/catalog/list?plugin=rezka&cat=films&sort=watching","Последние поступления":"/catalog/list?plugin=rezka&cat=films&sort=last","Популярные":"/catalog/list?plugin=rezka&cat=films&sort=popular"},"tv":{"Новинки":"/catalog/list?plugin=rezka&cat=series&sort=new","Сейчас смотрят":"/catalog/list?plugin=rezka&cat=series&sort=watching","Последние поступления":"/catalog/list?plugin=rezka&cat=series&sort=last","Популярные":"/catalog/list?plugin=rezka&cat=series&sort=popular"},"cartoons":{"Новинки":"/catalog/list?plugin=rezka&cat=cartoons&sort=new","Сейчас смотрят":"/catalog/list?plugin=rezka&cat=cartoons&sort=watching","Последние поступления":"/catalog/list?plugin=rezka&cat=cartoons&sort=last","Популярные":"/catalog/list?plugin=rezka&cat=cartoons&sort=popular"},"anime":{"Новинки":"/catalog/list?plugin=rezka&cat=animation&sort=new","Сейчас смотрят":"/catalog/list?plugin=rezka&cat=animation&sort=watching","Последние поступления":"/catalog/list?plugin=rezka&cat=animation&sort=last","Популярные":"/catalog/list?plugin=rezka&cat=animation&sort=popular"},"menu":{"Фильмы":"/catalog/list?plugin=rezka&cat=films&sort=last","Сериалы":"/catalog/list?plugin=rezka&cat=series&sort=last","Мультфильмы":"/catalog/list?plugin=rezka&cat=cartoons&sort=last","Аниме":"/catalog/list?plugin=rezka&cat=animation&sort=last"},"main":{"Фильмы • новинки":"/catalog/list?plugin=rezka&cat=films&sort=new","Фильмы • сейчас смотрят":"/catalog/list?plugin=rezka&cat=films&sort=watching","Фильмы • последние поступления":"/catalog/list?plugin=rezka&cat=films&sort=last","Фильмы • популярные":"/catalog/list?plugin=rezka&cat=films&sort=popular","Сериалы • новинки":"/catalog/list?plugin=rezka&cat=series&sort=new","Сериалы • сейчас смотрят":"/catalog/list?plugin=rezka&cat=series&sort=watching","Сериалы • последние поступления":"/catalog/list?plugin=rezka&cat=series&sort=last","Сериалы • популярные":"/catalog/list?plugin=rezka&cat=series&sort=popular","Мультфильмы • новинки":"/catalog/list?plugin=rezka&cat=cartoons&sort=new","Мультфильмы • сейчас смотрят":"/catalog/list?plugin=rezka&cat=cartoons&sort=watching","Мультфильмы • последние поступления":"/catalog/list?plugin=rezka&cat=cartoons&sort=last","Мультфильмы • популярные":"/catalog/list?plugin=rezka&cat=cartoons&sort=popular","Аниме • новинки":"/catalog/list?plugin=rezka&cat=animation&sort=new","Аниме • сейчас смотрят":"/catalog/list?plugin=rezka&cat=animation&sort=watching","Аниме • последние поступления":"/catalog/list?plugin=rezka&cat=animation&sort=last","Аниме • популярные":"/catalog/list?plugin=rezka&cat=animation&sort=popular"}},"Kinobase":{"search":"/catalog/list?plugin=kinobase","search_lazy":true,"movie":{"Обновления":"/catalog/list?plugin=kinobase&cat=films&sort=default","Текущий год":"/catalog/list?plugin=kinobase&cat=films&sort=year","Популярные за сутки":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_day","Популярные за неделю":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_week","Популярные за месяц":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_month","Популярные за все время":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_all","Рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=films&sort=rating","Рейтинг Кинопоиск":"/catalog/list?plugin=kinobase&cat=films&sort=kp_rating","Рейтинг IMDb":"/catalog/list?plugin=kinobase&cat=films&sort=imdb_rating"},"tv":{"Обновления":"/catalog/list?plugin=kinobase&cat=serials&sort=default","Текущий год":"/catalog/list?plugin=kinobase&cat=serials&sort=year","Популярные за сутки":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_day","Популярные за неделю":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_week","Популярные за месяц":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_month","Популярные за все время":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_all","Рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=serials&sort=rating","Рейтинг Кинопоиск":"/catalog/list?plugin=kinobase&cat=serials&sort=kp_rating","Рейтинг IMDb":"/catalog/list?plugin=kinobase&cat=serials&sort=imdb_rating"},"cartoons":{"Обновления":"/catalog/list?plugin=kinobase&cat=animation&sort=default","Текущий год":"/catalog/list?plugin=kinobase&cat=animation&sort=year","Популярные за сутки":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_day","Популярные за неделю":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_week","Популярные за месяц":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_month","Популярные за все время":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_all","Рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=animation&sort=rating","Рейтинг Кинопоиск":"/catalog/list?plugin=kinobase&cat=animation&sort=kp_rating","Рейтинг IMDb":"/catalog/list?plugin=kinobase&cat=animation&sort=imdb_rating"},"menu":{"Фильмы":"/catalog/list?plugin=kinobase&cat=films&sort=default","Сериалы":"/catalog/list?plugin=kinobase&cat=serials&sort=default","Телепередачи":"/catalog/list?plugin=kinobase&cat=tv&sort=default","Мультфильмы":"/catalog/list?plugin=kinobase&cat=animation&sort=default"},"main":{"Фильмы • обновления":"/catalog/list?plugin=kinobase&cat=films&sort=default","Фильмы • текущий год":"/catalog/list?plugin=kinobase&cat=films&sort=year","Фильмы • популярные за сутки":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_day","Фильмы • популярные за неделю":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_week","Фильмы • популярные за месяц":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_month","Фильмы • популярные за все время":"/catalog/list?plugin=kinobase&cat=films&sort=viewed_all","Фильмы • рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=films&sort=rating","Фильмы • рейтинг кинопоиск":"/catalog/list?plugin=kinobase&cat=films&sort=kp_rating","Фильмы • рейтинг imdb":"/catalog/list?plugin=kinobase&cat=films&sort=imdb_rating","Сериалы • обновления":"/catalog/list?plugin=kinobase&cat=serials&sort=default","Сериалы • текущий год":"/catalog/list?plugin=kinobase&cat=serials&sort=year","Сериалы • популярные за сутки":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_day","Сериалы • популярные за неделю":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_week","Сериалы • популярные за месяц":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_month","Сериалы • популярные за все время":"/catalog/list?plugin=kinobase&cat=serials&sort=viewed_all","Сериалы • рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=serials&sort=rating","Сериалы • рейтинг кинопоиск":"/catalog/list?plugin=kinobase&cat=serials&sort=kp_rating","Сериалы • рейтинг imdb":"/catalog/list?plugin=kinobase&cat=serials&sort=imdb_rating","Телепередачи • обновления":"/catalog/list?plugin=kinobase&cat=tv&sort=default","Телепередачи • текущий год":"/catalog/list?plugin=kinobase&cat=tv&sort=year","Телепередачи • популярные за сутки":"/catalog/list?plugin=kinobase&cat=tv&sort=viewed_day","Телепередачи • популярные за неделю":"/catalog/list?plugin=kinobase&cat=tv&sort=viewed_week","Телепередачи • популярные за месяц":"/catalog/list?plugin=kinobase&cat=tv&sort=viewed_month","Телепередачи • популярные за все время":"/catalog/list?plugin=kinobase&cat=tv&sort=viewed_all","Телепередачи • рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=tv&sort=rating","Телепередачи • рейтинг кинопоиск":"/catalog/list?plugin=kinobase&cat=tv&sort=kp_rating","Телепередачи • рейтинг imdb":"/catalog/list?plugin=kinobase&cat=tv&sort=imdb_rating","Мультфильмы • обновления":"/catalog/list?plugin=kinobase&cat=animation&sort=default","Мультфильмы • текущий год":"/catalog/list?plugin=kinobase&cat=animation&sort=year","Мультфильмы • популярные за сутки":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_day","Мультфильмы • популярные за неделю":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_week","Мультфильмы • популярные за месяц":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_month","Мультфильмы • популярные за все время":"/catalog/list?plugin=kinobase&cat=animation&sort=viewed_all","Мультфильмы • рейтинг пользователей":"/catalog/list?plugin=kinobase&cat=animation&sort=rating","Мультфильмы • рейтинг кинопоиск":"/catalog/list?plugin=kinobase&cat=animation&sort=kp_rating","Мультфильмы • рейтинг imdb":"/catalog/list?plugin=kinobase&cat=animation&sort=imdb_rating"}},"FilmixApp":{"search":"/catalog/list?plugin=filmixapp","search_lazy":true,"movie":{"Новинки":"/catalog/list?plugin=filmixapp&cat=s0&sort=year","Последние поступления":"/catalog/list?plugin=filmixapp&cat=s0&sort=date","Популярные":"/catalog/list?plugin=filmixapp&cat=s0&sort=rating"},"tv":{"Новинки":"/catalog/list?plugin=filmixapp&cat=s7&sort=year","Последние поступления":"/catalog/list?plugin=filmixapp&cat=s7&sort=date","Популярные":"/catalog/list?plugin=filmixapp&cat=s7&sort=rating"},"cartoons":{"Новинки":"/catalog/list?plugin=filmixapp&cat=s14&sort=year","Последние поступления":"/catalog/list?plugin=filmixapp&cat=s14&sort=date","Популярные":"/catalog/list?plugin=filmixapp&cat=s14&sort=rating"},"menu":{"Фильмы":"/catalog/list?plugin=filmixapp&cat=s0&sort=year","Сериалы":"/catalog/list?plugin=filmixapp&cat=s7&sort=year","Мультфильмы":"/catalog/list?plugin=filmixapp&cat=s14&sort=year","Мультсериалы":"/catalog/list?plugin=filmixapp&cat=s93&sort=year"},"main":{"Фильмы • новинки":"/catalog/list?plugin=filmixapp&cat=s0&sort=year","Фильмы • последние поступления":"/catalog/list?plugin=filmixapp&cat=s0&sort=date","Фильмы • популярные":"/catalog/list?plugin=filmixapp&cat=s0&sort=rating","Сериалы • новинки":"/catalog/list?plugin=filmixapp&cat=s7&sort=year","Сериалы • последние поступления":"/catalog/list?plugin=filmixapp&cat=s7&sort=date","Сериалы • популярные":"/catalog/list?plugin=filmixapp&cat=s7&sort=rating","Мультфильмы • новинки":"/catalog/list?plugin=filmixapp&cat=s14&sort=year","Мультфильмы • последние поступления":"/catalog/list?plugin=filmixapp&cat=s14&sort=date","Мультфильмы • популярные":"/catalog/list?plugin=filmixapp&cat=s14&sort=rating","Мультсериалы • новинки":"/catalog/list?plugin=filmixapp&cat=s93&sort=year","Мультсериалы • последние поступления":"/catalog/list?plugin=filmixapp&cat=s93&sort=date","Мультсериалы • популярные":"/catalog/list?plugin=filmixapp&cat=s93&sort=rating"}},"Filmix":{"search":"/catalog/list?plugin=filmix","search_lazy":true,"movie":{"Новинки":"/catalog/list?plugin=filmix&cat=film&sort=date"},"tv":{"Новинки":"/catalog/list?plugin=filmix&cat=seria&sort=date"},"cartoons":{"Новинки":"/catalog/list?plugin=filmix&cat=mults&sort=date"},"menu":{"Фильмы":"/catalog/list?plugin=filmix&cat=film&sort=date","Сериалы":"/catalog/list?plugin=filmix&cat=seria&sort=date","Мультфильмы":"/catalog/list?plugin=filmix&cat=mults&sort=date","Мультсериалы":"/catalog/list?plugin=filmix&cat=multser&sort=date"},"main":{"Фильмы • новинки":"/catalog/list?plugin=filmix&cat=film&sort=date","Сериалы • новинки":"/catalog/list?plugin=filmix&cat=seria&sort=date","Мультфильмы • новинки":"/catalog/list?plugin=filmix&cat=mults&sort=date","Мультсериалы • новинки":"/catalog/list?plugin=filmix&cat=multser&sort=date"}},"VoKino":{"search":"/catalog/list?plugin=vokino","search_lazy":true,"movie":{"В тренде":"/catalog/list?plugin=vokino&cat=movie&sort=popular","Новинки":"/catalog/list?plugin=vokino&cat=movie&sort=new","Обновления":"/catalog/list?plugin=vokino&cat=movie&sort=updatings","Лучшее":"/catalog/list?plugin=vokino&cat=movie&sort=rating"},"tv":{"В тренде":"/catalog/list?plugin=vokino&cat=serial&sort=popular","Новинки":"/catalog/list?plugin=vokino&cat=serial&sort=new","Обновления":"/catalog/list?plugin=vokino&cat=serial&sort=updatings","Лучшее":"/catalog/list?plugin=vokino&cat=serial&sort=rating"},"cartoons":{"В тренде":"/catalog/list?plugin=vokino&cat=multfilm&sort=popular","Новинки":"/catalog/list?plugin=vokino&cat=multfilm&sort=new","Обновления":"/catalog/list?plugin=vokino&cat=multfilm&sort=updatings","Лучшее":"/catalog/list?plugin=vokino&cat=multfilm&sort=rating"},"anime":{"В тренде":"/catalog/list?plugin=vokino&cat=anime&sort=popular","Новинки":"/catalog/list?plugin=vokino&cat=anime&sort=new","Обновления":"/catalog/list?plugin=vokino&cat=anime&sort=updatings","Лучшее":"/catalog/list?plugin=vokino&cat=anime&sort=rating"},"menu":{"Фильмы":"/catalog/list?plugin=vokino&cat=movie&sort=popular","Сериалы":"/catalog/list?plugin=vokino&cat=serial&sort=popular","Мультфильмы":"/catalog/list?plugin=vokino&cat=multfilm&sort=popular","Мультсериалы":"/catalog/list?plugin=vokino&cat=multserial&sort=popular","Аниме":"/catalog/list?plugin=vokino&cat=anime&sort=popular","Документальные фильмы":"/catalog/list?plugin=vokino&cat=documovie","Документальные сериалы":"/catalog/list?plugin=vokino&cat=docuserial","ТВ шоу":"/catalog/list?plugin=vokino&cat=tvshow"},"main":{"Фильмы • в тренде":"/catalog/list?plugin=vokino&cat=movie&sort=popular","Фильмы • новинки":"/catalog/list?plugin=vokino&cat=movie&sort=new","Фильмы • обновления":"/catalog/list?plugin=vokino&cat=movie&sort=updatings","Фильмы • лучшее":"/catalog/list?plugin=vokino&cat=movie&sort=rating","Сериалы • в тренде":"/catalog/list?plugin=vokino&cat=serial&sort=popular","Сериалы • новинки":"/catalog/list?plugin=vokino&cat=serial&sort=new","Сериалы • обновления":"/catalog/list?plugin=vokino&cat=serial&sort=updatings","Сериалы • лучшее":"/catalog/list?plugin=vokino&cat=serial&sort=rating","Мультфильмы • в тренде":"/catalog/list?plugin=vokino&cat=multfilm&sort=popular","Мультфильмы • новинки":"/catalog/list?plugin=vokino&cat=multfilm&sort=new","Мультфильмы • обновления":"/catalog/list?plugin=vokino&cat=multfilm&sort=updatings","Мультфильмы • лучшее":"/catalog/list?plugin=vokino&cat=multfilm&sort=rating","Мультсериалы • в тренде":"/catalog/list?plugin=vokino&cat=multserial&sort=popular","Мультсериалы • новинки":"/catalog/list?plugin=vokino&cat=multserial&sort=new","Мультсериалы • обновления":"/catalog/list?plugin=vokino&cat=multserial&sort=updatings","Мультсериалы • лучшее":"/catalog/list?plugin=vokino&cat=multserial&sort=rating","Аниме • в тренде":"/catalog/list?plugin=vokino&cat=anime&sort=popular","Аниме • новинки":"/catalog/list?plugin=vokino&cat=anime&sort=new","Аниме • обновления":"/catalog/list?plugin=vokino&cat=anime&sort=updatings","Аниме • лучшее":"/catalog/list?plugin=vokino&cat=anime&sort=rating","Документальные фильмы":"/catalog/list?plugin=vokino&cat=documovie","Документальные сериалы":"/catalog/list?plugin=vokino&cat=docuserial","ТВ шоу":"/catalog/list?plugin=vokino&cat=tvshow"}},"Eneyida":{"search":"/catalog/list?plugin=eneyida","search_lazy":true,"movie":{"Новинки":"/catalog/list?plugin=eneyida&cat=films&sort=update","Популярні":"/catalog/list?plugin=eneyida&cat=films&sort=views","Рейтинг":"/catalog/list?plugin=eneyida&cat=films&sort=rating"},"tv":{"Новинки":"/catalog/list?plugin=eneyida&cat=series&sort=update","Популярні":"/catalog/list?plugin=eneyida&cat=series&sort=views","Рейтинг":"/catalog/list?plugin=eneyida&cat=series&sort=rating"},"cartoons":{"Новинки":"/catalog/list?plugin=eneyida&cat=cartoon&sort=update","Популярні":"/catalog/list?plugin=eneyida&cat=cartoon&sort=views","Рейтинг":"/catalog/list?plugin=eneyida&cat=cartoon&sort=rating"},"anime":{"Новинки":"/catalog/list?plugin=eneyida&cat=anime&sort=update","Популярні":"/catalog/list?plugin=eneyida&cat=anime&sort=views","Рейтинг":"/catalog/list?plugin=eneyida&cat=anime&sort=rating"},"menu":{"Фільми":"/catalog/list?plugin=eneyida&cat=films&sort=update","Серіали":"/catalog/list?plugin=eneyida&cat=series&sort=update","Мультфільми":"/catalog/list?plugin=eneyida&cat=cartoon&sort=update","Мультсеріали":"/catalog/list?plugin=eneyida&cat=cartoon-series&sort=update","Аніме":"/catalog/list?plugin=eneyida&cat=anime&sort=update"},"main":{"Фільми • новинки":"/catalog/list?plugin=eneyida&cat=films&sort=update","Фільми • популярні":"/catalog/list?plugin=eneyida&cat=films&sort=views","Фільми • рейтинг":"/catalog/list?plugin=eneyida&cat=films&sort=rating","Серіали • новинки":"/catalog/list?plugin=eneyida&cat=series&sort=update","Серіали • популярні":"/catalog/list?plugin=eneyida&cat=series&sort=views","Серіали • рейтинг":"/catalog/list?plugin=eneyida&cat=series&sort=rating","Мультфільми • новинки":"/catalog/list?plugin=eneyida&cat=cartoon&sort=update","Мультфільми • популярні":"/catalog/list?plugin=eneyida&cat=cartoon&sort=views","Мультфільми • рейтинг":"/catalog/list?plugin=eneyida&cat=cartoon&sort=rating","Мультсеріали • новинки":"/catalog/list?plugin=eneyida&cat=cartoon-series&sort=update","Мультсеріали • популярні":"/catalog/list?plugin=eneyida&cat=cartoon-series&sort=views","Мультсеріали • рейтинг":"/catalog/list?plugin=eneyida&cat=cartoon-series&sort=rating","Аніме • новинки":"/catalog/list?plugin=eneyida&cat=anime&sort=update","Аніме • популярні":"/catalog/list?plugin=eneyida&cat=anime&sort=views","Аніме • рейтинг":"/catalog/list?plugin=eneyida&cat=anime&sort=rating"}},"KinoUkr":{"search_lazy":true,"movie":{"Останні оновлення":"/catalog/list?plugin=kinoukr&cat=films&sort=default"},"tv":{"Останні оновлення":"/catalog/list?plugin=kinoukr&cat=seriess&sort=default"},"cartoons":{"Останні оновлення":"/catalog/list?plugin=kinoukr&cat=cartoons&sort=default"},"menu":{"Фільми":"/catalog/list?plugin=kinoukr&cat=films&sort=default","Серіали":"/catalog/list?plugin=kinoukr&cat=seriess&sort=default","Мультфільми":"/catalog/list?plugin=kinoukr&cat=cartoons&sort=default","Мультсеріали":"/catalog/list?plugin=kinoukr&cat=cartoon-series&sort=default"},"main":{"Фільми • останні оновлення":"/catalog/list?plugin=kinoukr&cat=films&sort=default","Серіали • останні оновлення":"/catalog/list?plugin=kinoukr&cat=seriess&sort=default","Мультфільми • останні оновлення":"/catalog/list?plugin=kinoukr&cat=cartoons&sort=default","Мультсеріали • останні оновлення":"/catalog/list?plugin=kinoukr&cat=cartoon-series&sort=default"}},"AniLiberty":{"search":"/catalog/list?plugin=aniliberty","search_lazy":true,"tv":{"Новинки":"/catalog/list?plugin=aniliberty&cat=serial&sort=default"},"movie":{"Новинки":"/catalog/list?plugin=aniliberty&cat=movie&sort=default"},"menu":{"Сериалы":"/catalog/list?plugin=aniliberty&cat=serial&sort=default","Фильмы":"/catalog/list?plugin=aniliberty&cat=movie&sort=default"},"main":{"Сериалы • новинки":"/catalog/list?plugin=aniliberty&cat=serial&sort=default","Фильмы • новинки":"/catalog/list?plugin=aniliberty&cat=movie&sort=default"}}}};

    function account(url){url=url+'';if(url.indexOf('account_email=')==-1){var email=Lampa.Storage.get('account_email');if(email)url=Lampa.Utils.addUrlComponent(url,'account_email='+encodeURIComponent(email));}if(url.indexOf('uid=')==-1){var uid=Lampa.Storage.get('lampac_unic_id','');if(uid)url=Lampa.Utils.addUrlComponent(url,'uid='+encodeURIComponent(uid));}if(url.indexOf('token=')==-1){var token='';if(token!='')url=Lampa.Utils.addUrlComponent(url,'token=');}return url;}var Utils = {account:account};

    var network=new Lampa.Reguest();/**
     * Формирование URL для запросов
     * @param {string} u - метод API
     * @param {object} params - параметры запроса
     * @returns {string} - полный URL
     */function url(u){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(params.page)u=add(u,'page='+params.page);if(params.query)u=add(u,'query='+params.query);return Manifest.api_host+Utils.account(u);}/**
     * Добавление параметра к URL
     * @param {string} u - URL
     * @param {string} params - параметры запроса
     * @returns {string} - URL с добавленным параметром
     */function add(u,params){return u+(/\?/.test(u)?'&':'?')+params;}/**
     * Запрос к API
     * @param {string} method - метод API
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     * @param {function} onerror - функция ошибки
     */function get(method){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var oncomplite=arguments.length>2?arguments[2]:undefined;var onerror=arguments.length>3?arguments[3]:undefined;var u=url(method,params);network.silent(u,function(json){json.url=method;oncomplite(addSource(json));},onerror);}function getCatalog(){return Manifest.catalogs[Lampa.Storage.field('source')];}function addSource(data,custom){var source=custom||Lampa.Storage.field('source');if(Lampa.Arrays.isObject(data)&&Lampa.Arrays.isArray(data.results)){data.results.forEach(function(item){if(!item.source)item.source=source;});}else if(Lampa.Arrays.isArray(data)){data.forEach(function(item){if(!item.source)item.source=source;});}return data;}/**
     * Главная страница
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     * @param {function} onerror - функция ошибки
     * @returns {function} - функция для загрузки следующей части
     */function main(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var oncomplite=arguments.length>1?arguments[1]:undefined;var onerror=arguments.length>2?arguments[2]:undefined;var catalog=getCatalog();var parts_limit=6;var parts_data=[];if(catalog&&catalog.main){var addPart=function addPart(title,url){parts_data.push(function(call){get(url,params,function(json){json.title=title;call(json);},call);});};for(var i in catalog.main){addPart(i,Utils.account(catalog.main[i]));}}else return onerror();function loadPart(partLoaded,partEmpty){Lampa.Api.partNext(parts_data,parts_limit,partLoaded,partEmpty);}loadPart(oncomplite,onerror);return loadPart;}/**
     * Категория
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     * @param {function} onerror - функция ошибки
     * @returns {function} - функция для загрузки следующей части
     */function category(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var oncomplite=arguments.length>1?arguments[1]:undefined;var onerror=arguments.length>2?arguments[2]:undefined;var catalog=getCatalog();var parts_limit=6;var parts_data=[];if(catalog&&catalog[params.url]){var addPart=function addPart(title,url){parts_data.push(function(call){get(url,params,function(json){json.title=title;call(json);},call);});};for(var i in catalog[params.url]){addPart(i,Utils.account(catalog[params.url][i]));}}else return onerror();function loadPart(partLoaded,partEmpty){Lampa.Api.partNext(parts_data,parts_limit,partLoaded,partEmpty);}loadPart(oncomplite,onerror);return loadPart;}/**
     * Полный просмотр категории (фильмы, сериалы, аниме)
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     * @param {function} onerror - функция ошибки
     */function list(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var oncomplite=arguments.length>1?arguments[1]:undefined;var onerror=arguments.length>2?arguments[2]:undefined;if(params.genres&&typeof params.genres=='number')return Lampa.Api.sources.tmdb.list(params,oncomplite,onerror);var u=url(params.id||params.genres||params.url,params);network.silent(u,oncomplite,onerror);}function full(params,oncomplite){var require=1;// Количество обязательных запросов
    var status=new Lampa.Status(require);status.onComplite=oncomplite;var url='/catalog/card?plugin='+params.source+'&uri='+encodeURIComponent(params.id)+'&type='+(params.method||'movie');get(Utils.account(url),params,function(json){// Источник
    json.source=params.source;if(json.seasons&&json.seasons.length){var season=Lampa.Utils.countSeasons(json);if(season){status.need++;Lampa.Api.sources.tmdb.get('tv/'+json.tmdb_id+'/season/'+season,{},function(ep){status.append('episodes',ep);},status.error.bind(status));}}if(json.tmdb_id){status.need++;Lampa.Api.sources.cub.reactionsGet({id:json.tmdb_id,method:json.original_name?'tv':'movie'},function(reactions){status.append('reactions',reactions);});}if(json.credits)status.data['persons']=json.credits;if(json.recommendations)status.data['recomend']=addSource({results:json.recommendations},'tmdb');if(json.similar)status.data['simular']=addSource({results:json.similar},'tmdb');if(json.videos)status.data['videos']=addSource({results:json.videos},'tmdb');// Результат
    status.append('movie',json);},function(){status.error();});}/**
     * Поиск
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     * @returns {void}
     */function search(catalog_name){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var oncomplite=arguments.length>2?arguments[2]:undefined;var catalog=Manifest.catalogs[catalog_name];if(!catalog||!catalog.search)return oncomplite([]);var u=Utils.account(catalog.search);if(!u)return oncomplite([]);get(u,params,function(json){json.title='Найдено';json.results.forEach(function(item){item.source=catalog_name;});oncomplite([json]);},function(){oncomplite([]);});}function person(){var params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var oncomplite=arguments.length>1?arguments[1]:undefined;var onerror=arguments.length>2?arguments[2]:undefined;Lampa.Api.sources.tmdb.person(params,oncomplite,onerror);}/**
     * Добавить кнопку в поисковую строку
     * @returns {object} - объект кнопки
     */function discovery(catalog_name){var catalog=Manifest.catalogs[catalog_name];return {title:catalog_name,search:search.bind(search,catalog_name),params:{align_left:true,lazy:(catalog===null||catalog===void 0?void 0:catalog.search_lazy)||false,object:{source:catalog_name}},onMore:function onMore(params){// Переход из кнопки "Ещё"
    Lampa.Activity.push({url:catalog.search,title:Lampa.Lang.translate('search')+' - '+params.query,component:'category_full',page:2,query:encodeURIComponent(params.query),source:catalog_name});},onCancel:network.clear.bind(network)};}/**
     * Получить список категорий для каталога в меню
     * @param {object} params - параметры запроса
     * @param {function} oncomplite - функция успешного завершения
     */function menu(params,oncomplite){var menu=[];var catalog=getCatalog();if(catalog){for(var i in catalog.menu){menu.push({title:i,id:catalog.menu[i]});}}oncomplite(menu);}function clear(){network.clear();}var Api = {main:main,menu:menu,full:full,list:list,category:category,clear:clear,discovery:discovery,getCatalog:getCatalog,person:person};

    function loadCatalogs(){if(Manifest.catalogs&&Object.keys(Manifest.catalogs).length){var keys=Object.keys(Manifest.catalogs);keys.forEach(function(key){Lampa.Params.values.source[key]=key;Object.defineProperty(Lampa.Api.sources,key,{get:function get(){return Api;}});if(Manifest.catalogs[key].search)Lampa.Search.addSource(Api.discovery(key));});}else {var network=new Lampa.Reguest();network.silent(Utils.account(Manifest.api_host+'/catalog'),function(json){var keys=Object.keys(json);Manifest.catalogs=json;keys.forEach(function(key){Lampa.Params.values.source[key]=key;Object.defineProperty(Lampa.Api.sources,key,{get:function get(){return Api;}});if(Manifest.catalogs[key].search)Lampa.Search.addSource(Api.discovery(key));});});}Lampa.Listener.follow('menu',function(e){if(e.type=='action'&&(e.action=='tv'||e.action=='cartoon'||e.action=='anime'||e.action=='movie'||e.action=='relise')){var catalog=Api.getCatalog();if(!catalog)return;var actionMap={movie:{key:'movie',title:'menu_movies'},tv:{key:'tv',title:'menu_tv'},cartoon:{key:'cartoons',title:'menu_multmovie'},anime:{key:'anime',title:'menu_anime'},relise:{key:'relise',title:'menu_relise'}};if(actionMap[e.action]){var groupKey=actionMap[e.action].key;var group=catalog[groupKey];if(group&&Object.keys(group).length==1){var url=group[Object.keys(group)[0]];Lampa.Router.call('category_full',{url:url,title:Lampa.Lang.translate(actionMap[e.action].title)+' - '+Lampa.Storage.field('source').toUpperCase()});e.abort();}else if(group){Lampa.Router.call('category',{url:actionMap[e.action].key,title:Lampa.Lang.translate(actionMap[e.action].title)+' - '+Lampa.Storage.field('source').toUpperCase()});e.abort();}}}});}function startPlugin(){window.plugin_catalog=true;if(window.appready)loadCatalogs();else {Lampa.Listener.follow('app',function(e){if(e.type=='ready')loadCatalogs();});}}if(!window.plugin_catalog)startPlugin();

})();